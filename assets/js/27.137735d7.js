(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{302:function(e,t,n){"use strict";n.r(t);var a=n(13),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"realty-management-part-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#realty-management-part-2"}},[e._v("#")]),e._v(" Realty Management - Part 2")]),e._v(" "),t("p",[e._v("This is a continuation of "),t("RouterLink",{attrs:{to:"/exercises/realty_management.html"}},[e._v("Realty Management - Part 1")])],1),e._v(" "),t("p",[e._v("To further expand the functionalities of your application, the realty agency has come back to your company with the following change requests:")]),e._v(" "),t("h2",{attrs:{id:"terminating-tenancies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#terminating-tenancies"}},[e._v("#")]),e._v(" Terminating Tenancies")]),e._v(" "),t("p",[e._v("They want to be able to terminate a tenancy easily, without having to wait for the system to check every single day.")]),e._v(" "),t("p",[e._v("To realize this, create a new "),t("strong",[e._v("Server Action")]),e._v(" bound to the tenancy model, that terminates any tenancy selected from the tree view or opened in a form view.")]),e._v(" "),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("< CREATE THE SERVER ACTION >\n<record id='<CUSTOM_ID>' model='ir.actions.server'>\n    ...\n    <field name='state'>code</field>\n    <field name='code'>\n        ...\n    </field>\n    ...\n</record>\n\n< THE SERVER ACTION SHOULD CALL A FUNCTION ON THE TENANCY MODEL>\n\ndef action_terminate_tenancies(self):\n    ...\n\n")])])]),t("h2",{attrs:{id:"separate-views-for-tenancies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#separate-views-for-tenancies"}},[e._v("#")]),e._v(" Separate Views for Tenancies")]),e._v(" "),t("p",[e._v("The agency wants to have separate views for terminated and draft/ongoing tenancies.")]),e._v(" "),t("p",[e._v("To realize this, create a new "),t("strong",[e._v("Window Action")]),e._v(" that displays only terminated tenancies, and edit the initial action created in "),t("RouterLink",{attrs:{to:"/exercises/realty_management.html#tenancies"}},[e._v("Realty Management - Part 1")]),e._v(" to display only tenancies that are not terminated.")],1),e._v(" "),t("p",[e._v("Add the new action under the Tenancies parent menu.")]),e._v(" "),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("< CREATE THE WINDOW ACTION >\n<record id='<CUSTOM_ID>' model='ir.actions.act_window'>\n    ...\n    <field name='domain'>[('state' '=', ...)]</field>\n    ...\n</record>\n")])])]),t("p",[e._v("No need to create new views. You can use the same view with two different actions.")]),e._v(" "),t("h2",{attrs:{id:"redirect-to-agency-s-portal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redirect-to-agency-s-portal"}},[e._v("#")]),e._v(" Redirect to Agency's portal")]),e._v(" "),t("p",[e._v("The agency has its own website that can be found at the following url: "),t("code",[e._v("https://portal.fake-agency.com/")]),e._v("\nThey want to redirect the user to a page on their portal when click on a button from the "),t("strong",[e._v("Form")]),e._v(" view.\nTo do this, create two new "),t("strong",[e._v("URL Actions")]),e._v(", one for tenancies, the other for properties, that redirects the user to the following urls:")]),e._v(" "),t("ul",[t("li",[e._v("Tenancies: "),t("strong",[e._v("<PORTAL_URL>")]),e._v("/tenancies/"),t("strong",[e._v("<TENANCY_ID>")])]),e._v(" "),t("li",[e._v("Properties: "),t("strong",[e._v("<PORTAL_URL>")]),e._v("/properties/"),t("strong",[e._v("<PROPERTY_ID>")])])]),e._v(" "),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('< ADD A BUTTON TO THE FORM VIEWS >\n...\n<div class="oe_button_box">\n    <button class="oe_stat_button" type="..." name="..."\n            icon="fa-link" string="View on Portal"/>\n</div>\n...\n\n< CREATE THE URL ACTION >\n<record id=\'<CUSTOM_ID>\' model=\'ir.actions.act_url\'>\n    ...\n    <field name=\'url\'>...</field>\n    ...\n</record>\n')])])]),t("h2",{attrs:{id:"tenancy-cancellation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tenancy-cancellation"}},[e._v("#")]),e._v(" Tenancy Cancellation")]),e._v(" "),t("p",[e._v("The agency wishes to have a new button on the "),t("strong",[e._v("Form")]),e._v(" view of the tenancies. The button should read \"Cancel\".\nUpon clicking on the button, the tenancy should be cancelled, i.e: its state should change to 'cancelled', however this should only be possible if the tenancy is neither Terminated nor Draft.")]),e._v(" "),t("p",[e._v("When a tenancy is cancelled, its tenant_ids field should be emptied.")]),e._v(" "),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('< ADD A BUTTON ON THE HEADER OF THE FORM VIEW >\n\n<form>\n    <header>\n        <button class="btn-secondary" type="..." action="..."\n            icon="fa-trash" string="Cancel"/>\n    </header>\n    <sheet>\n        ...\n    </sheet>\n</form>\n\n')])])]),t("p",[e._v("When trying to reset the tenant_ids, use either "),t("strong",[e._v("Magic Numbers")]),e._v(" or "),t("strong",[e._v("Commands")]),e._v(" to clear the field.")]),e._v(" "),t("h2",{attrs:{id:"set-default-tenant-on-tenancy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-default-tenant-on-tenancy"}},[e._v("#")]),e._v(" Set Default Tenant on Tenancy")]),e._v(" "),t("p",[e._v("The agency wishes to create a new tenant for every new Tenancy created.\nTo achieve this, we can override the "),t("code",[e._v("def create(self, vals)")]),e._v(" method on the tenancy model, and use "),t("strong",[e._v("Magic Numbers")]),e._v(" or "),t("strong",[e._v("Commands")]),e._v(" to set the value of the "),t("code",[e._v("tenant_ids")]),e._v(" field.")]),e._v(" "),t("p",[e._v("The default tenant should have the following values:")]),e._v(" "),t("ul",[t("li",[e._v("Name: Default Tenant")]),e._v(" "),t("li",[e._v("Email: tenant@agency.test")])]),e._v(" "),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("< OVERRIDE THE CREATE METHOD ON THE TENANCY MODEL >\n\n@api...\ndef create(self, vals | vals_list)\n    ...\n    self._assign_default_tenant(vals)\n    ...\n\ndef _assign_default_tenant(self, vals)\n    ...Use Magic Numbers to assign a default tenant on the tenant_ids field in the vals dict\n\n")])])]),t("p",[t("strong",[e._v("Hint 2:")]),e._v("\nThis can also be done using the "),t("code",[e._v("context")]),e._v(" field on the "),t("strong",[e._v("Window Action")])]),e._v(" "),t("h2",{attrs:{id:"new-report-for-properties"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#new-report-for-properties"}},[e._v("#")]),e._v(" New Report for Properties")]),e._v(" "),t("p",[e._v("The agency wants to be able to print a document with the details of any given property(ies).\nTo achieve this, create a new pdf report for the Properties model, that simply displays the following information:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Property Name:\n_______________________________________\n\nConstruction Date:                  Rent Price:                 Surface:\nNumber of Rooms:                    Parking Spots:              Furnishing:\n\nAddress:\n________________________________________\n\nStreet:                             City:                       Zip Code:\nState:                              Country:\n\n")])])]),t("p",[t("strong",[e._v("Hint:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("< DEFINE A NEW REPORT ACTION >\n<record id='<CUSTOM_ID>' model='ir.actions.report'>\n    ...\n    <field name='report_name'><MODULE_NAME>.property_sheet</field>\n    <field name='report_file'><MODULE_NAME>.property_sheet</field>\n    ...\n</record>\n\n< DEFINE A NEW QWEB TEMPLATE FOR YOUR REPORT >\n<template id=\"property_sheet\">\n    <t t-call=\"web.html_container\">\n        <t t-foreach=\"docs\" t-as=\"o\">\n            <t t-call=\"web.external_layout\">\n                <div class=\"page\">\n\n                    Define the architecture of your report. In this case,\n                    if you want to access data on a record, for example\n                    the name of a property, you can simply do:\n\n                    <h1>\n                        Property Name: <t t-esc='o.name' />\n                    </h1>\n\n                    Because 'docs' contains the list of records selected\n                    from a tree/form view, and we loop over docs to get\n                    a reference for every property in the 'o' variable\n\n                </div>\n            </t>\n        </t>\n    </t>\n</template>\n\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);